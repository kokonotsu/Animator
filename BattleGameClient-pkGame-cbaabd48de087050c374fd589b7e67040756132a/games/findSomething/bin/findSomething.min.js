var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},FindSomeThing;!function(e){var t=function(){function e(){var e=this;this.rightTime=200,this.falseTime=1500,this.rightNum=10,this.choose=function(){var t=Math.random();t<e.isRight?e.aiRight():e.aiWrong()},this.nextRound=function(){App.TimerManager.removeAll(e),App.IsXiaoMi?(e.totalTime=1e3*GameFindSomethingView.aiConf.s+Math.floor(GameFindSomethingView.aiConf.r*Math.random()),console.log(e.totalTime)):e.setTotalTime(),e.setFalseNum(),e.rightNum=10},this.aiRight=function(){App.TimerManager.doTimer(e.rightTime,1,function(){e.currentNum>0&&e.currentNum--,0==e.currentNum&&e.chooseTitle();var t=GameFindSomethingView.instance.scoreController.comRight();e.rightNum--,t&&e.choose()},e)},this.aiWrong=function(){e.wrongFlag&&clearTimeout(e.wrongFlag),e.wrongFlag=setTimeout(e.choose,e.falseTime),e.falseNum--},this.dispose=function(){App.TimerManager.removeAll(e),e.wrongFlag&&clearTimeout(e.wrongFlag)},this.random=new Math.seedrandom(DataCenter.instance.room.id+"randomTitle"+GameFindSomethingView.instance.roundController.currentRound),App.IsXiaoMi?(this.totalTime=1e3*GameFindSomethingView.aiConf.s+Math.floor(GameFindSomethingView.aiConf.r*Math.random()),console.log(this.totalTime)):this.setTotalTime(),this.setFalseNum()}return e.prototype.setTotalTime=function(){var e,t=2.5*(13-App.CurrGameAiLevel),i=Math.random();App.CurrGameAiLevel>1&&App.CurrGameAiLevel<10?e=Math.round(5*i):1==App.CurrGameAiLevel?e=Math.round(10*i):10==App.CurrGameAiLevel&&(e=Math.round(3*i),t=9),this.totalTime=1e3*(t+e)},e.prototype.setFalseNum=function(){var e=this.totalTime-10*this.rightTime;0>e?this.falseNum=0:this.falseNum=Math.floor(e/this.falseTime)},Object.defineProperty(e.prototype,"isRight",{get:function(){return this.falseNum<=0?1:this.rightNum/(this.falseNum+this.rightNum)},enumerable:!0,configurable:!0}),e.prototype.chooseTitle=function(){var e=GameFindSomethingView.instance.gameController.titleList,t=GameFindSomethingView.instance.gameController.titleMap,i=Math.floor(this.random()*e.length);return this.currentTitle===e[i]?void this.chooseTitle():(this.currentTitle=e[i],void(t[this.currentTitle]<3?this.currentNum=Math.ceil(this.random()*t[this.currentTitle]):this.currentNum=Math.ceil(3*this.random())))},e}();e.AiController=t,__reflect(t.prototype,"FindSomeThing.AiController")}(FindSomeThing||(FindSomeThing={}));var FindSomeThing;!function(e){var t=function(){function e(t,i,n,o){var r=this;this.titleMap={},this.titleList=[],this.pushTitle=function(e){for(var t=0,i=e;t<i.length;t++){var n=i[t];r.titleMap[n]?r.titleMap[n]++:(r.titleMap[n]=1,r.titleList.push(n))}},this.delayTipTitle=function(){r.clearDelayTipTitle(),r.tipFlag=setTimeout(r.tipTitleFicker,e.TipTime)},this.clearDelayTipTitle=function(){r.tipFlag&&(clearTimeout(r.tipFlag),r.tipFlag=void 0)},this.tipTitleFicker=function(){r.isTipFicking=!0,r.tipEffect.startFlicker(r.tipTitle,500)},this.tipTitleStop=function(){r.isTipFicking=!1,r.tipEffect.stopFlicker(r.tipTitle),r.tipTitle.alpha=1},this.isItemFlick=!1,this.tipNum=3,this.stopFicker=function(e){r.isItemFlick&&(r.effect.stopFlicker(r.tipItem.img),r.isItemFlick=!1,e==r.tipItem?r.tipItem.img.alpha=.5:r.tipItem.img.alpha=1)},this.showTip=function(){if(GameFindSomethingView.instance.isGameing&&!r.isItemFlick&&(r.tipNum--,!(r.tipNum<0))){r.tipNum>0?(r.tipTitleStop(),r.delayTipTitle()):(r.clearDelayTipTitle(),r.tipTitleStop());var e=GameFindSomethingView.instance.GameScrollerGroup;r.btn_tip.source="FindSometingTip"+r.tipNum+"_png",App.SoundManager.playEffect("FindSomethingTip_mp3",!0),r.tipItem=GameFindSomethingView.instance.itemController.getItem(r.currentTitle);var t=r.tipItem.x-e.width/2;if(0>t&&(t=0),t>1800-e.width&&(t=1800-e.width),r.effect.startFlicker(r.tipItem.img,400),r.isItemFlick=!0,t>e.scrollH){var i=Math.floor((t-e.scrollH)/GameFindSomethingView.scrollerSpeed);if(0==i)return;App.TimerManager.doFrame(1,i,function(){e.scrollH+=GameFindSomethingView.scrollerSpeed},r,function(){e.scrollH=t},r)}else{var i=Math.floor((e.scrollH-t)/GameFindSomethingView.scrollerSpeed);if(0==i)return;App.TimerManager.doFrame(1,i,function(){e.scrollH-=GameFindSomethingView.scrollerSpeed},r,function(){e.scrollH=t},r)}}},this.nextRound=function(){r.titleMap={},r.titleList=[],r.random=new Math.seedrandom(DataCenter.instance.room.id+"randomTitle"+GameFindSomethingView.instance.roundController.currentRound),r.clearDelayTipTitle(),r.tipTitleStop(),r.targetNum=GameFindSomethingView.instance.scoreController.targetNum},this.dispose=function(){r.titleMap={},r.titleList=[],egret.Tween.removeTweens(r.leftCloud),egret.Tween.removeTweens(r.rightCloud),r.leftCloud.x=-1,r.rightCloud.x=641,r.isItemFlick&&(r.effect.stopFlicker(r.tipItem.img),r.isItemFlick=!1),r.clearDelayTipTitle(),r.tipTitleStop(),r.btn_tip.removeEventListener(egret.TouchEvent.TOUCH_TAP,r.showTip,r)},this.itemConfigTip=RES.getRes("ItemConfig_json").tip,this.random=new Math.seedrandom(DataCenter.instance.room.id+"randomTitle"+GameFindSomethingView.instance.roundController.currentRound),this.leftCloud=t,this.rightCloud=i,this.tipTitle=o,this.btn_tip=n,this.btn_tip.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showTip,this),this.effect=new EffectUtils,this.tipEffect=new EffectUtils,this.targetNum=GameFindSomethingView.instance.scoreController.targetNum}return e.prototype.chooseTitle=function(){if(0==this.targetNum)return void(GameFindSomethingView.instance.currentTitleView.text="第"+GameFindSomethingView.instance.roundController.currentRound+"局结束");var e=Math.floor(this.random()*this.titleList.length);return this.currentTitle===this.titleList[e]?void this.chooseTitle():(this.currentTitle=this.titleList[e],this.titleMap[this.currentTitle]<3?this.currentNum=Math.ceil(this.random()*this.titleMap[this.currentTitle]):this.currentNum=Math.ceil(3*this.random()),this.targetNum<this.currentNum&&(this.currentNum=this.targetNum),this.targetNum-=this.currentNum,void(GameFindSomethingView.instance.currentTitleView.text=this.itemConfigTip[this.currentTitle]+"X"+this.currentNum))},e.prototype.tapRight=function(e){for(var t=0,i=e;t<i.length;t++){var n=i[t];if(this.titleMap[n]>1)this.titleMap[n]--;else{delete this.titleMap[n];var o=this.titleList.indexOf(n);this.titleList.splice(o,1)}}this.currentNum>0&&(this.currentNum--,GameFindSomethingView.instance.currentTitleView.text=this.itemConfigTip[this.currentTitle]+"X"+this.currentNum),0==this.currentNum&&this.chooseTitle(),App.SoundManager.playEffect("FindSomethingRight_mp3",!0),GameFindSomethingView.instance.scoreController.selfRight(),this.tipNum>0&&(this.tipTitleStop(),this.delayTipTitle())},e.prototype.tapFalse=function(){App.SoundManager.playEffect("FingSomethingFalse_mp3",!0),egret.Tween.get(this.leftCloud).to({x:320},400).wait(700).to({x:-1},400),egret.Tween.get(this.rightCloud).to({x:320},400).wait(700).to({x:641},400)},e.TipTime=1e4,e}();e.GameController=t,__reflect(t.prototype,"FindSomeThing.GameController")}(FindSomeThing||(FindSomeThing={}));var GameFindSomethingView=function(e){function t(){var i=e.call(this,App.IsWanba?GameFindSomethingViewSkinWanba:GameFindSomethingViewSkin)||this;return i.isGameing=!1,i.readyStart=function(){DataCenter.instance.room.IsAI&&(i.aiController.chooseTitle(),i.aiController.choose()),i.gameController.chooseTitle(),i.GameScroller.scrollPolicyH="on",i.isGameing=!0,App.TimerManager.doTimer(1e3,t.time,i.countDown,i),i.gameController.tipNum>0&&i.gameController.delayTipTitle()},i.onGameResult=function(e){DataCenter.instance.room.gameResult=e,i.popup("GameResult")},i.nextRound=function(){i.isGameing=!1,i.GameScroller.scrollPolicyH="off",egret.Tween.get(i.roundBG).to({alpha:1},300).wait(600).call(function(){switch(i.GameScrollerGroup.scrollH=0,i.gameController.nextRound(),i.itemController.nextRound(),i.scoreController.nextRound(),DataCenter.instance.room.IsAI&&i.aiController.nextRound(),i.time=t.time,i.Time.text=i.time.toString(),App.Language){case LanguageType.Ch:i.currentTitleView.text="第"+i.roundController.currentRound+"局开始";break;case LanguageType.En:i.currentTitleView.text="Round "+i.roundController.currentRound+" Start"}}).to({alpha:0},300).call(function(){i.ready.play()})},i.time=t.time,i.countDown=function(){i.time--,i.Time.text=i.time.toString(),0==i.time&&i.scoreController.roundOver()},i.stopTime=function(){App.TimerManager.remove(i.countDown,i)},t.instance=i,i}return __extends(t,e),t.prototype.init=function(){var i=this;switch(e.prototype.init.call(this),this.scoreController=new FindSomeThing.ScoreController(this.SelfCurrent,this.ComCurrent),this.roundController=new FindSomeThing.RoundController(this.SelfScore1,this.SelfScore2,this.ComScore1,this.ComScore2),this.gameController=new FindSomeThing.GameController(this.leftCloud,this.rightCloud,this.btn_tip,this.tipTitle),this.itemController=new FindSomeThing.ItemController,this.initUserData(),DataCenter.instance.room.IsAI&&App.IsXiaoMi?App.MessageCenter.dispatch(EventMessage.GetDataC2S,function(e){t.aiConf=e[App.CurrGameAiLevel],console.log("IsXiaoMi"+App.CurrGameAiLevel+"   "+JSON.stringify(t.aiConf)),i.ready=new GameReady(i.readyStart),i.ready.x=300,i.ready.y=App.GameHeight/2,i.addChild(i.ready),i.ready.play(),i.aiController=new FindSomeThing.AiController}):(this.ready=new GameReady(this.readyStart),this.ready.x=300,this.ready.y=App.GameHeight/2,this.addChild(this.ready),this.ready.play(),DataCenter.instance.room.IsAI&&(this.aiController=new FindSomeThing.AiController)),App.MessageCenter.addListener(EventMessage.ReceiveGameResultS2C,this.onGameResult,this),App.MessageCenter.addListener(EventMessage.GameSendExpress,this.addQiPaoCartoon,this),App.MessageCenter.addListener(EventMessage.ReceiveGameEventS2C,this.onGameEvent,this),App.GameHeight<1136&&(this.gp_bg.scaleY=this.gp_bg.scaleX=App.GameHeight/1136),this.roundBG=new egret.Shape,this.roundBG.alpha=0,this.roundBG.graphics.beginFill(0),this.roundBG.graphics.drawRect(0,0,App.GameWidth,App.GameHeight),this.roundBG.graphics.endFill(),this.addChild(this.roundBG),this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.popup("GameSureLeave")},this),(App.IsXiaoMi||App.IsWanba)&&(this.btn_return.visible=!1),this.btn_hello.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sayHello,this),this.GameScroller.scrollPolicyH="off",App.SoundManager.playBg("FindSomethingBGMusic_mp3"),App.Language){case LanguageType.Ch:this.currentTitleView.text="第"+this.roundController.currentRound+"局开始";break;case LanguageType.En:this.currentTitleView.text="Round "+this.roundController.currentRound+" Start"}},t.prototype.initUserData=function(){var e=DataCenter.instance.user,i=DataCenter.instance.room.player,n=new RoleHeadImage(e.imgUrl);n.scaleX=n.scaleY=.85,this.SelfAvatarGroup.addChild(n),this.SelfSex.source=GameCenterGetSexIcon.getSexIconSource(e.sex),this.SelfName.text=e.name,this.SelfName.text.length>t.nameLength&&(this.SelfName.size*=t.nameLength/this.SelfName.text.length);var o=new RoleHeadImage(i.imgUrl);o.scaleX=o.scaleY=.85,this.ComAvatarGroup.addChild(o),this.ComSex.source=GameCenterGetSexIcon.getSexIconSource(i.sex),this.ComName.text=i.name,this.ComName.text.length>t.nameLength&&(this.ComName.size*=t.nameLength/this.ComName.text.length)},t.prototype.onGameEvent=function(e){var t=function(e){var t=e.split("|");return t},i=t(e.event);switch(i[0]){case"sendExpress":this.addQiPaoCartoon(i[1],2)}},t.prototype.addQiPaoCartoon=function(e,t){void 0===t&&(t=1);var i=new QIPaoCartoon;if(i.y=App.RandomUtils.limitInteger(120,130),this.addChild(i),2==t)i.x=App.RandomUtils.limitInteger(App.GameWidth-105,App.GameWidth-85),i.setSouce(e,!0);else if(i.setSouce(e),i.x=App.RandomUtils.limitInteger(85,105),DataCenter.instance.room.IsAI){var n=App.RandomUtils.limitInteger(1,5);n%2!=0&&App.TimerManager.doTimer(1e3*n,1,this.AddAIexpress,this)}else{var o="sendExpress|"+e;App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,o)}i.onPlay()},t.prototype.AddAIexpress=function(){var e=["1_1","1_2","1_3","1_4","1_5","1_6","2_1","2_2","2_3","2_4","3_1","3_2","3_3","3_4"],t=App.RandomUtils.limitInteger(0,13),i="express"+e[t]+"_png";this.addQiPaoCartoon(i,2)},t.prototype.sayHello=function(){App.GameExpressType=1,this.popup("GameExpress")},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.itemController.dispose(),this.gameController.dispose(),this.roundController.dispose(),this.scoreController.dispose(),DataCenter.instance.room.IsAI&&this.aiController.dispose(),this.ready.dispose(),egret.Tween.removeTweens(this.roundBG),App.TimerManager.removeAll(this),App.MessageCenter.removeListener(EventMessage.ReceiveGameResultS2C,this.onGameResult,this),App.MessageCenter.removeListener(EventMessage.GameSendExpress,this.addQiPaoCartoon,this),App.MessageCenter.removeListener(EventMessage.ReceiveGameEventS2C,this.onGameEvent,this),this.btn_hello.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sayHello,this)},t.nameLength=6,t.time=90,t.scrollerSpeed=30,t.aiConf={},t}(StateEui);__reflect(GameFindSomethingView.prototype,"GameFindSomethingView");var FindSomeThing;!function(e){var t=function(){function e(){var t=this;this.initData=function(){var e=RES.getRes("ItemConfig_json").map;t.itemConfigMap={};for(var i in e)t.itemConfigMap[i]=e[i];var n=RES.getRes("ItemConfig_json").list;t.itemConfigList=[];for(var o=0,r=n;o<r.length;o++){var i=r[o];t.itemConfigList.push(i)}},this.itemNum=0,this.numChildren=0,this.addItem=function(e){void 0===e&&(e=!1),t.itemNum++;var n=Math.floor(t.itemConfigList.length*t.random());if(t.numChildren=GameFindSomethingView.instance.GameScrollerGroup.numChildren,void 0!==t.itemConfigList[n]){var o=t.itemConfigList[n],r=new i("FindSomething_"+o+"_png",t.itemConfigMap[o]);if(delete t.itemConfigMap[o],t.itemConfigList.splice(n,1),e){var a=t.addSmallItem(r);a&&t.addItem(e)}else if(r.width===r.height){var s=t.random();if(.3>s){var a=t.addSmallItem(r);a&&t.addItem(!1)}else t.addBigItem(r)}else r.width>r.height?t.addWidthItem(r):t.addHeightItem(r)}},this.nextRound=function(){t.clearItem(),t.initData(),t.random=new Math.seedrandom(DataCenter.instance.room.id+"randomItem"+GameFindSomethingView.instance.roundController.currentRound),t.map=[];for(var i=0;i<e.mapRow;i++){for(var n=[],o=0;o<e.mapCell;o++)n.push(!1);t.map.push(n)}t.tarRow=t.tarCell=0,t.addItem()},this.getItem=function(e){for(var i=0,n=t.itemList;i<n.length;i++){var o=n[i];if(o.touchEnabled)for(var r=0,a=o.tags;r<a.length;r++){var s=a[r];if(e===s)return o}}},this.dispose=function(){t.clearItem(),t.map=[]},App.IsWanba&&(e.mapCellEdge=70),this.initData(),this.itemList=[],this.random=new Math.seedrandom(DataCenter.instance.room.id+"randomItem"+GameFindSomethingView.instance.roundController.currentRound),this.map=[];for(var n=0;n<e.mapRow;n++){for(var o=[],r=0;r<e.mapCell;r++)o.push(!1);this.map.push(o)}this.tarRow=this.tarCell=0,this.addItem()}return e.prototype.addHeightItem=function(t){var i=this,n=t.width/(e.mapCellEdge-10),o=Math.ceil(n),r=function(){for(var e=0;o>e;e++){if(void 0==i.map[i.tarRow+e]||void 0==i.map[i.tarRow+e][i.tarCell])return!0;if(i.map[i.tarRow+e][i.tarCell])return!0}return!1};if(r())for(;r();)if(this.getNextGrid(),this.tarRow+o>=e.mapRow){this.tarRow=this.tarCell=0;var a=this.addSmallItem(t);return void(a&&this.addItem(!0))}var s=e.mapCellEdge-10,h=t.height/n,l=this.tarRow*e.mapCellEdge+.5*e.mapCellEdge,m=this.tarCell*e.mapCellEdge+e.mapCellEdge*n*.5+5;t.setImage(s,h,m,l);for(var d=0;o>d;d++)this.map[this.tarRow+d][this.tarCell]=!0;this.getNextGrid(),GameFindSomethingView.instance.GameScrollerGroup.addChild(t),this.itemList.push(t),this.addItem(!1)},e.prototype.addWidthItem=function(t){var i=this,n=t.height/(e.mapCellEdge-10),o=Math.ceil(n),r=function(){for(var e=0;o>e;e++){if(void 0==i.map[i.tarRow]||void 0==i.map[i.tarRow][i.tarCell+e])return!0;if(i.map[i.tarRow][i.tarCell+e])return!0}return!1};if(r())for(;r();)if(this.getNextGrid(),this.tarCell+o>=e.mapCell&&(this.tarRow++,this.tarCell=0),this.tarRow+1>=e.mapRow){var a=this.addSmallItem(t);return void(a&&this.addItem(!0))}var s=this.tarRow*e.mapCellEdge+e.mapCellEdge*n*.5+5,h=this.tarCell*e.mapCellEdge+.5*e.mapCellEdge,l=e.mapCellEdge-10,m=t.width/n;t.setImage(m,l,h,s);for(var d=0;o>d;d++)this.map[this.tarRow][this.tarCell+d]=!0;this.getNextGrid(o),GameFindSomethingView.instance.GameScrollerGroup.addChild(t),this.itemList.push(t),this.addItem(!1)},e.prototype.addBigItem=function(t){var i=this,n=function(){if(void 0==i.map[i.tarRow+1]||void 0==i.map[i.tarRow+1][i.tarCell+1])return!0;var e=i.map[i.tarRow][i.tarCell]||i.map[i.tarRow][i.tarCell+1]||i.map[i.tarRow+1][i.tarCell+1]||i.map[i.tarRow+1][i.tarCell];return e};if(n())for(;n();)if(this.getNextGrid(),this.tarCell+1>=e.mapCell&&(this.tarRow++,this.tarCell=0),this.tarRow+1>=e.mapRow){this.tarRow=this.tarCell=0;var o=this.addSmallItem(t);return void(o&&this.addItem(!0))}var r=this.tarRow*e.mapCellEdge+e.mapCellEdge,a=this.tarCell*e.mapCellEdge+e.mapCellEdge;t.setImage(2*e.mapCellEdge,2*e.mapCellEdge,a,r),this.map[this.tarRow][this.tarCell]=!0,this.map[this.tarRow][this.tarCell+1]=!0,this.map[this.tarRow+1][this.tarCell]=!0,this.map[this.tarRow+1][this.tarCell+1]=!0,this.getNextGrid(2),GameFindSomethingView.instance.GameScrollerGroup.addChild(t),this.itemList.push(t),this.addItem(!1)},e.prototype.addSmallItem=function(t){var i=this,n=function(){return i.map[i.tarRow][i.tarCell]};if(n())for(var o=!0;n();)if(this.getNextGrid(),this.tarCell>=e.mapCell&&(this.tarRow++,this.tarCell=0),this.tarRow==e.mapRow-1&&this.tarCell==e.mapCell-1){if(!o)return!1;o=!1}var r=this.tarRow*e.mapCellEdge+.5*e.mapCellEdge,a=this.tarCell*e.mapCellEdge+.5*e.mapCellEdge;return t.setImage(e.mapCellEdge,e.mapCellEdge,a,r),this.map[this.tarRow][this.tarCell]=!0,this.getNextGrid(),GameFindSomethingView.instance.GameScrollerGroup.addChild(t),this.itemList.push(t),!0},e.prototype.getNextGrid=function(t){void 0===t&&(t=1),this.tarCell=this.tarCell+t,this.tarCell>=e.mapCell&&(this.tarRow++,this.tarCell=0),this.tarRow>=e.mapRow&&(this.tarRow=0,this.tarCell=0)},e.prototype.clearItem=function(){for(var e=0,t=this.itemList;e<t.length;e++){var i=t[e];GameFindSomethingView.instance.GameScrollerGroup.removeChild(i),i.dispose()}this.itemList=[]},e.mapCell=28,e.mapRow=10,e.mapCellEdge=64,e}();e.ItemController=t,__reflect(t.prototype,"FindSomeThing.ItemController");var i=function(e){function t(t,i){var n=e.call(this)||this;return n.tap=function(){if(GameFindSomethingView.instance.isGameing){GameFindSomethingView.instance.gameController.stopFicker(n);for(var e=0,t=n.tags;e<t.length;e++){var i=t[e];if(GameFindSomethingView.instance.gameController.currentTitle===i){n.touchEnabled=!1,n.img.alpha=.5,GameFindSomethingView.instance.gameController.tapRight(n.tags);var o=AssetManager.getBitmap("FindSomethingV_png");return o.width=.7*n.img.width,o.height=.7*n.img.height,o.width>o.height?o.width=o.height:o.height=o.width,o.anchorOffsetX=.5*o.width,o.anchorOffsetY=.5*o.height,o.x=n.img.x,o.y=n.img.y,void n.addChild(o)}}GameFindSomethingView.instance.gameController.tapFalse();var r=AssetManager.getBitmap("FindSomethingX_png");r.width=.7*n.img.width,r.height=.7*n.img.height,r.width>r.height?r.width=r.height:r.height=r.width,r.anchorOffsetX=.5*r.width,r.anchorOffsetY=.5*r.height,r.x=n.img.x,r.y=n.img.y,n.addChild(r),App.TimerManager.doTimer(1e3,1,function(){n.removeChild(r),App.TimerManager.removeAll(n)},n)}},n.dispose=function(){n.removeEventListener(egret.TouchEvent.TOUCH_TAP,n.tap,n),n.removeChildren(),App.TimerManager.removeAll(n)},n.img=AssetManager.getBitmap(t),n.tags=i,GameFindSomethingView.instance.gameController.pushTitle(n.tags),n.addChild(n.img),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,n.tap,n),n}return __extends(t,e),t.prototype.setImage=function(e,t,i,n){this.img.width=e,this.img.height=t,this.img.anchorOffsetX=.5*this.img.width,this.img.anchorOffsetY=.5*this.img.height,this.x=i,this.y=n,this.img.x=0,this.img.y=0},t}(egret.DisplayObjectContainer);e.Item=i,__reflect(i.prototype,"FindSomeThing.Item")}(FindSomeThing||(FindSomeThing={}));var FindSomeThing;!function(e){var t=function(){function e(e,t,i,n){var o=this;this.selfRound=0,this.comRound=0,this.currentRound=1,this.round={},this.playWinCartoon=function(e,t){o.findSomethingScore||(o.findSomethingScore=AssetManager.getBitmap("FindSomethingScore_png")),o.findSomethingScore.scaleX=o.findSomethingScore.scaleY=1.2,o.findSomethingScore.y=e.y,o.findSomethingScore.x=e.x,o.findSomethingScore.anchorOffsetX=.5*o.findSomethingScore.width,o.findSomethingScore.anchorOffsetY=.5*o.findSomethingScore.height,GameFindSomethingView.instance.gp_bg.addChild(o.findSomethingScore),egret.Tween.get(o.findSomethingScore).to({scaleX:2,scaleY:2},300).to({scaleX:1,scaleY:1},200).wait(1e3).call(function(){o.findSomethingScore.parent&&o.findSomethingScore.parent.removeChild(o.findSomethingScore),e.source=o.findSomethingScore.texture,t&&t()})},this.SelfScore1=e,this.SelfScore2=t,this.ComScore1=i,this.ComScore2=n,App.MessageCenter.addListener(EventMessage.ReceiveGameEventS2C,this.onGameEvent,this)}return e.prototype.winRound=function(){var e=this;switch(GameFindSomethingView.instance.stopTime(),App.Language){case LanguageType.Ch:GameFindSomethingView.instance.currentTitleView.text="第"+this.currentRound+"局结束";break;case LanguageType.En:GameFindSomethingView.instance.currentTitleView.text="Round "+this.currentRound+" Over"}this.currentRound++;var t=function(){e.selfRound++,e.selfRound>=2?e.sendResult(3):e.nextRound()};0===this.selfRound?(this.SelfScore1.source="FindSomethingScore_png",this.playWinCartoon(this.SelfScore1,t)):(this.SelfScore2.source="FindSomethingScore_png",this.playWinCartoon(this.SelfScore2,t)),App.SoundManager.playEffect("FindSomethingRoundWin_mp3",!0)},e.prototype.loseRound=function(){var e=this;switch(GameFindSomethingView.instance.stopTime(),App.Language){case LanguageType.Ch:GameFindSomethingView.instance.currentTitleView.text="第"+this.currentRound+"局结束";break;case LanguageType.En:GameFindSomethingView.instance.currentTitleView.text="Round "+this.currentRound+" Over"}this.currentRound++;var t=function(){e.comRound++,e.comRound>=2?e.sendResult(1):e.nextRound()};0===this.comRound?(this.ComScore1.source="FindSomethingScore_png",this.playWinCartoon(this.ComScore1,t)):(this.ComScore2.source="FindSomethingScore_png",this.playWinCartoon(this.ComScore2,t))},e.prototype.nextRound=function(){GameFindSomethingView.instance.nextRound()},e.prototype.sendResult=function(e){App.MessageCenter.dispatch(EventMessage.SendGameResultC2S,e)},e.prototype.onGameEvent=function(e){var t=function(e){var t=e.split("|");return t},i=t(e.event);if(void 0==this.round[i[1]])switch(i[0]){case"roundWin":e.userId===DataCenter.instance.user.id?this.winRound():this.loseRound(),this.round[i[1]]=DataCenter.instance.user.name;break;case"roundLose":e.userId===DataCenter.instance.user.id?this.loseRound():this.winRound(),this.round[i[1]]=DataCenter.instance.room.player.name}},e.prototype.dispose=function(){App.MessageCenter.removeListener(EventMessage.ReceiveGameEventS2C,this.onGameEvent,this)},e}();e.RoundController=t,__reflect(t.prototype,"FindSomeThing.RoundController")}(FindSomeThing||(FindSomeThing={}));var FindSomeThing;!function(e){var t=function(){function e(e,t){var i=this;this._selfRightNum=0,this._comRightNum=0,this.targetNum=10,this.comRight=function(){return i._comRightNum++,i.ComScore.text=i._comRightNum.toString(),i._comRightNum>=i.targetNum?(GameFindSomethingView.instance.isGameing=!1,App.TimerManager.doFrame(1,1,function(){GameFindSomethingView.instance.roundController.loseRound()},i),!1):!0},this.nextRound=function(){i._selfRightNum=0,i._comRightNum=0,i.SelfScore.text=i._selfRightNum.toString(),i.ComScore.text=i._comRightNum.toString()},this.roundOver=function(){DataCenter.instance.room.IsAI?i._selfRightNum>=i._comRightNum?GameFindSomethingView.instance.roundController.winRound():GameFindSomethingView.instance.roundController.loseRound():i._selfRightNum>=i._comRightNum?App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,"roundWin|"+GameFindSomethingView.instance.roundController.currentRound,1):App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,"roundLose|"+GameFindSomethingView.instance.roundController.currentRound,1)},this.SelfScore=e,this.ComScore=t,App.MessageCenter.addListener(EventMessage.ReceiveGameEventS2C,this.onGameEvent,this)}return e.prototype.selfRight=function(){this._selfRightNum++,this.SelfScore.text=this._selfRightNum.toString(),DataCenter.instance.room.IsAI?this._selfRightNum>=this.targetNum&&(GameFindSomethingView.instance.aiController.dispose(),App.TimerManager.doFrame(1,1,function(){GameFindSomethingView.instance.roundController.winRound()},this)):(App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,"score|"+this._selfRightNum),this._selfRightNum>=this.targetNum&&App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,"roundWin|"+GameFindSomethingView.instance.roundController.currentRound,1))},Object.defineProperty(e.prototype,"selfRightNum",{get:function(){return this._selfRightNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"comRightNum",{get:function(){return this._comRightNum},enumerable:!0,configurable:!0}),e.prototype.onGameEvent=function(e){var t=function(e){var t=e.split("|");return t},i=t(e.event);switch(i[0]){case"score":this.ComScore.text=i[1],this._comRightNum=parseInt(i[1]),this._comRightNum>=this.targetNum&&App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,"roundLose|"+GameFindSomethingView.instance.roundController.currentRound,1)}},e.prototype.dispose=function(){App.MessageCenter.removeListener(EventMessage.ReceiveGameEventS2C,this.onGameEvent,this)},e}();e.ScoreController=t,__reflect(t.prototype,"FindSomeThing.ScoreController")}(FindSomeThing||(FindSomeThing={}));