var __reflect=this&&this.__reflect||function(e,s,i){e.__class__=s,i?i.push(s):i=[s],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,s){function i(){this.constructor=e}for(var t in s)s.hasOwnProperty(t)&&(e[t]=s[t]);i.prototype=s.prototype,e.prototype=new i},AIChessFive=function(){function e(){this.ChessArr=[],this.TempThree=[],this.ArrSelf4=["01111","10111","11011","11101","11110"],this.ArrAI=["02222","20222","22022","22202","22220"],this.type=0,this.Decision_X=-1,this.Decision_Y=-1,this.AIWin=0,this.InitValueX=7,this.InitValueY=7,this.AllCanPot=[]}return e.prototype.onJudce=function(){if(0==this.onJudceWinFour(!0))if(0==this.onJudceWinFour())this.onValueOfPot();else{var e=this.onJudceWinFour();this.onDecisionFour(e)}else{var e=this.onJudceWinFour(!0);this.onDecisionFour(e)}},e.prototype.onJudceWinFour=function(e){void 0===e&&(e=!1);var s=[];s=e?this.ArrAI:this.ArrSelf4;for(var i=0;11>i;++i)for(var t=0;15>t;t++){for(var n="",h=0;5>h;++h)n+=this.ChessArr[i+h][t];if(n==s[0]||n==s[1]||n==s[2]||n==s[3]||n==s[4])return this.Init_X=i,this.Init_Y=t,this.type=1,e&&(this.AIWin=1),n}for(var i=0;15>i;++i)for(var t=0;11>t;t++){for(var n="",h=0;5>h;++h)n+=this.ChessArr[i][t+h];if(n==s[0]||n==s[1]||n==s[2]||n==s[3]||n==s[4])return this.Init_X=i,this.Init_Y=t,this.type=2,e&&(this.AIWin=2),n}for(var i=0;11>i;++i)for(var t=0;11>t;t++){for(var n="",h=0;5>h;++h)n+=this.ChessArr[i+h][t+h];if(n==s[0]||n==s[1]||n==s[2]||n==s[3]||n==s[4])return this.Init_X=i,this.Init_Y=t,this.type=3,e&&(this.AIWin=3),n}for(var i=4;15>i;++i)for(var t=0;11>t;t++){for(var n="",h=0;5>h;++h)n+=this.ChessArr[i-h][t+h];if(n==s[0]||n==s[1]||n==s[2]||n==s[3]||n==s[4])return this.Init_X=i,this.Init_Y=t,e&&(this.AIWin=4),this.type=4,n}return 0},e.prototype.onJudceWinDoubleFour=function(e){void 0===e&&(e=!1),this.AllCanPot=[];for(var s=0;15>s;s++)for(var i=0;15>i;i++)if(0==this.ChessArr[s][i]){var t=[s,i];this.AllCanPot.push(t)}var n="";n=e?"2":"1";for(var h=this.AllCanPot.length,s=0;h>s;++s){this.AllCanPot[s][0],this.AllCanPot[s][1]}return 0},e.prototype.onJudceWinThree=function(e){void 0===e&&(e=!1);var s,i=[];e?(s="02220",i=["022020","020220"]):(s="01110",i=["011010","010110"]);for(var t=0;11>t;++t)for(var n=0;15>n;n++){for(var h="",o=0;5>o;++o)h+=this.ChessArr[t+o][n];if(h==s){if(0==t&&0==this.ChessArr[t+5][n])h="3"+h+"0";else if(10==t&&0==this.ChessArr[t-1][n])h="0"+h+"3";else if(t>0&&10>t){var a=this.ChessArr[t-1][n],r=this.ChessArr[t+5][n];(0==a||0==r)&&(h=""+a+h+r)}if(h.length>5)return this.Init_X=t,this.Init_Y=n,this.type=1,h}}for(var t=0;15>t;++t)for(var n=0;11>n;n++){for(var h="",o=0;5>o;++o)h+=this.ChessArr[t][n+o];if(h==s){if(0==n&&0==this.ChessArr[t][n+5])h="3"+h+"0";else if(10==n&&0==this.ChessArr[t][n-1])h="0"+h+"3";else if(n>0&&10>n){var a=this.ChessArr[t][n-1],r=this.ChessArr[t][n+5];(0==a||0==r)&&(h=""+a+h+r)}if(h.length>5)return this.Init_X=t,this.Init_Y=n,this.type=2,h}}for(var t=0;11>t;++t)for(var n=0;11>n;n++){for(var h="",o=0;5>o;++o)h+=this.ChessArr[t+o][n+o];if(h==s){if(0==t&&10!=n)0==this.ChessArr[t+5][n+5]&&(h="3"+h+"0");else if(10!=t&&0==n)0==this.ChessArr[t+5][n+5]&&(h="3"+h+"0");else if(10==t&&0!=n)0==this.ChessArr[t-1][n-1]&&(h="0"+h+"3");else if(0!=t&&10==n)0==this.ChessArr[t-1][n-1]&&(h="0"+h+"3");else if(10>t&&t>0&&10>n&&n>0){var a=this.ChessArr[t-1][n-1],r=this.ChessArr[5+t][n+5];(0==a||0==r)&&(h=""+a+h+r)}if(h.length>5)return this.Init_X=t,this.Init_Y=n,this.type=3,h}}for(var t=4;15>t;++t)for(var n=0;11>n;n++){for(var h="",o=0;5>o;++o)h+=this.ChessArr[t-o][n+o];if(h==s){if(0==n&&4!=t)0==this.ChessArr[t-5][n+5]&&(h="3"+h+"0");else if(10!=n&&14==t)0==this.ChessArr[t-5][n+5]&&(h="3"+h+"0");else if(10!=n&&4==t)0==this.ChessArr[t+1][n-1]&&(h="0"+h+"3");else if(10==n&&14!=t)0==this.ChessArr[t+1][n-1]&&(h="0"+h+"3");else if(14>t&&t>4&&10>n&&n>0){var r=this.ChessArr[t-5][n+5],a=this.ChessArr[t+1][n+1];(0==a||0==r)&&(h=""+a+h+r)}if(h.length>5)return this.Init_X=t,this.Init_Y=n,this.type=4,h}}for(var t=0;10>t;++t)for(var n=0;15>n;n++){for(var h="",o=0;6>o;++o)h+=this.ChessArr[t+o][n];if(h==i[0]||h==i[1])return this.Init_X=t,this.Init_Y=n,this.type=1,h}for(var t=0;15>t;++t)for(var n=0;10>n;n++){for(var h="",o=0;6>o;++o)h+=this.ChessArr[t][n+o];if(h==i[0]||h==i[1])return this.Init_X=t,this.Init_Y=n,this.type=2,h}for(var t=0;10>t;++t)for(var n=0;10>n;n++){for(var h="",o=0;6>o;++o)h+=this.ChessArr[t+o][n+o];if(h==i[0]||h==i[1])return this.Init_X=t,this.Init_Y=n,this.type=3,h}for(var t=5;15>t;++t)for(var n=0;10>n;n++){for(var h="",o=0;6>o;++o)h+=this.ChessArr[t-o][n+o];if(h==i[0]||h==i[1])return this.Init_X=t,this.Init_Y=n,this.type=4,h}return 0},e.prototype.onDecisionFour=function(e){switch(this.type){case 1:"01111"==e||"02222"==e?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y):"10111"==e||"20222"==e?(this.Decision_X=this.Init_X+1,this.Decision_Y=this.Init_Y):"11011"==e||"22022"==e?(this.Decision_X=this.Init_X+2,this.Decision_Y=this.Init_Y):"11101"==e||"22202"==e?(this.Decision_X=this.Init_X+3,this.Decision_Y=this.Init_Y):("11110"==e||"22220"==e)&&(this.Decision_X=this.Init_X+4,this.Decision_Y=this.Init_Y);break;case 2:"01111"==e||"02222"==e?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y):"10111"==e||"20222"==e?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y+1):"11011"==e||"22022"==e?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y+2):"11101"==e||"22202"==e?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y+3):("11110"==e||"22220"==e)&&(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y+4);break;case 3:"01111"==e||"02222"==e?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y):"10111"==e||"20222"==e?(this.Decision_X=this.Init_X+1,this.Decision_Y=this.Init_Y+1):"11011"==e||"22022"==e?(this.Decision_X=this.Init_X+2,this.Decision_Y=this.Init_Y+2):"11101"==e||"22202"==e?(this.Decision_X=this.Init_X+3,this.Decision_Y=this.Init_Y+3):("11110"==e||"22220"==e)&&(this.Decision_X=this.Init_X+4,this.Decision_Y=this.Init_Y+4);break;case 4:"01111"==e||"02222"==e?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y):"10111"==e||"20222"==e?(this.Decision_X=this.Init_X-1,this.Decision_Y=this.Init_Y+1):"11011"==e||"22022"==e?(this.Decision_X=this.Init_X-2,this.Decision_Y=this.Init_Y+2):"11101"==e||"22202"==e?(this.Decision_X=this.Init_X-3,this.Decision_Y=this.Init_Y+3):("11110"==e||"22220"==e)&&(this.Decision_X=this.Init_X-4,this.Decision_Y=this.Init_Y+4)}},e.prototype.onDecisionThree=function(e){switch(this.type){case 1:"022020"==e?(this.Decision_X=this.Init_X+3,this.Decision_Y=this.Init_Y):"020220"==e?(this.Decision_X=this.Init_X+2,this.Decision_Y=this.Init_Y):-1!=e.indexOf("022200")?(this.Decision_X=this.Init_X+4,this.Decision_Y=this.Init_Y):("0022201"==e||"0022203"==e||"0022200"==e)&&(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y);break;case 2:"022020"==e?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y+3):"020220"==e?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y+2):-1!=e.indexOf("022200")?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y+4):("0022201"==e||"0022203"==e||"0022200"==e)&&(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y);break;case 3:"022020"==e?(this.Decision_X=this.Init_X+3,this.Decision_Y=this.Init_Y+3):"020220"==e?(this.Decision_X=this.Init_X+2,this.Decision_Y=this.Init_Y+2):-1!=e.indexOf("022200")?(this.Decision_X=this.Init_X+4,this.Decision_Y=this.Init_Y+4):("0022201"==e||"0022203"==e||"0022200"==e)&&(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y);break;case 4:"022020"==e?(this.Decision_X=this.Init_X-3,this.Decision_Y=this.Init_Y+3):"020220"==e?(this.Decision_X=this.Init_X-2,this.Decision_Y=this.Init_Y+2):-1!=e.indexOf("022200")?(this.Decision_X=this.Init_X-4,this.Decision_Y=this.Init_Y+4):("0022201"==e||"0022203"==e||"0022200"==e)&&(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y)}},e.prototype.onDecisionGradeThree=function(e){switch(this.type){case 1:"011010"==e?(this.Decision_X=this.Init_X+3,this.Decision_Y=this.Init_Y):"010110"==e?(this.Decision_X=this.Init_X+2,this.Decision_Y=this.Init_Y):-1!=e.indexOf("011100")?(this.Decision_X=this.Init_X+4,this.Decision_Y=this.Init_Y):("0011102"==e||"0011103"==e||"0011100"==e)&&(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y);break;case 2:"011010"==e?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y+3):"010110"==e?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y+2):-1!=e.indexOf("011100")?(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y+4):("0011102"==e||"0011103"==e||"0011100"==e)&&(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y);break;case 3:"011010"==e?(this.Decision_X=this.Init_X+3,this.Decision_Y=this.Init_Y+3):"010110"==e?(this.Decision_X=this.Init_X+2,this.Decision_Y=this.Init_Y+2):-1!=e.indexOf("011100")?(this.Decision_X=this.Init_X+4,this.Decision_Y=this.Init_Y+4):("0011102"==e||"0011103"==e||"0011100"==e)&&(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y);break;case 4:"011010"==e?(this.Decision_X=this.Init_X-3,this.Decision_Y=this.Init_Y+3):"010110"==e?(this.Decision_X=this.Init_X-2,this.Decision_Y=this.Init_Y+2):-1!=e.indexOf("011100")?(this.Decision_X=this.Init_X-4,this.Decision_Y=this.Init_Y+4):("0011102"==e||"0011103"==e||"0011100"==e)&&(this.Decision_X=this.Init_X,this.Decision_Y=this.Init_Y)}},e.prototype.onValueOfPot=function(){this.AllCanPot=[];for(var e=0;15>e;e++)for(var s=0;15>s;s++)if(0==this.ChessArr[e][s]){var i=100-Math.abs(this.InitValueX-e)-Math.abs(this.InitValueY-s),t=[e,s,i];this.AllCanPot.push(t)}for(var n=this.AllCanPot.length,e=0;n>e;e++)this.onStructureDoubleFour(e);if(this.AllCanPot.sort(function(e,s){return e[2]>s[2]?-1:1}),this.AllCanPot[0][2]<1e4){var h=this.onJudceWinThree(!0);if(0==h){var o=this.onJudceWinThree(!1);0==o?this.AllCanPot.length-1>=GameFiveinARowView.AILEVEL?(this.Decision_X=this.AllCanPot[GameFiveinARowView.AILEVEL][0],this.Decision_Y=this.AllCanPot[GameFiveinARowView.AILEVEL][1]):(this.Decision_X=this.AllCanPot[0][0],this.Decision_Y=this.AllCanPot[0][1]):this.onDecisionGradeThree(o)}else this.onDecisionThree(h)}else this.Decision_X=this.AllCanPot[0][0],this.Decision_Y=this.AllCanPot[0][1]},e.prototype.onStructureDoubleFour=function(e){for(var s=this.AllCanPot[e][0],i=this.AllCanPot[e][1],t=(this.AllCanPot[e][2],0),n=0,h=0,o=0,a=0,r=0,_="",m="",c="",u="",p="",l="",C="",f="",v="",d=-4;4>=d;++d){var g=s+d;g>=0&&14>=g&&(v+=this.ChessArr[g][i],0==d?(p+="2",_+="1"):(p+=this.ChessArr[g][i],_+=this.ChessArr[g][i]))}for(var I="",d=-4;4>=d;++d){var g=i+d;g>=0&&14>=g&&(I+=this.ChessArr[s][g],0==d?(l+="2",m+="1"):(l+=this.ChessArr[s][g],m+=this.ChessArr[s][g]))}for(var A="",d=-4;4>=d;++d){var E=s+d,b=i+d;E>=0&&14>=E&&b>=0&&14>=b&&(A+=this.ChessArr[E][b],0==d?(C+="2",c+="1"):(C+=this.ChessArr[E][b],c+=this.ChessArr[E][b]))}for(var S="",d=-4;4>=d;++d){var E=s-d,b=i+d;E>=0&&14>=E&&b>=0&&14>=b&&(S+=this.ChessArr[E][b],0==d?(f+="2",u+="1"):(f+=this.ChessArr[E][b],u+=this.ChessArr[E][b]))}for(var Y="",T="",D="",X=1;5>X;X++){switch(X){case 1:Y=v,T=p,D=_;break;case 2:Y=I,T=l,D=m;break;case 3:Y=A,T=C,D=c;break;case 4:Y=S,T=f,D=u}var y=Y.length;y>=5&&(-1!=T.indexOf("02222")||-1!=T.indexOf("20222")||-1!=T.indexOf("22022")||-1!=T.indexOf("22202")||-1!=T.indexOf("22220")?(n++,-1!=T.indexOf("2022202")&&(n+=1)):((-1!=T.indexOf("002220")||-1!=T.indexOf("022200")||-1!=T.indexOf("022020")||-1!=T.indexOf("020220"))&&a++,(-1!=T.indexOf("002220")||-1!=T.indexOf("022200"))&&r++),-1!=D.indexOf("01111")||-1!=D.indexOf("10111")||-1!=D.indexOf("11011")||-1!=D.indexOf("11101")||-1!=D.indexOf("11110")?(t++,-1!=D.indexOf("1011101")&&(t+=1)):((-1!=D.indexOf("001110")||-1!=D.indexOf("011100")||-1!=D.indexOf("011010")||-1!=D.indexOf("010110"))&&h++,(-1!=D.indexOf("001110")||-1!=D.indexOf("011100"))&&o++))}return n>1?void(this.AllCanPot[e][2]+=1e4):t>1?void(this.AllCanPot[e][2]+=8e3):1==n&&a>0?void(this.AllCanPot[e][2]+=9e3):1==t&&h>0?void(this.AllCanPot[e][2]+=7e3):a>1?void(this.AllCanPot[e][2]+=6e3):h>1?void(this.AllCanPot[e][2]+=5e3):1==r?void(this.AllCanPot[e][2]+=3e3):1==o?void(this.AllCanPot[e][2]+=4e3):void 0},e}();__reflect(AIChessFive.prototype,"AIChessFive");var ChessmanFive=function(e){function s(s){var i=e.call(this)||this;return i.img1=App.DisplayUtils.createBitmap("chessman_"+s+"_png"),i.addChild(i.img1),i.anchorOffsetX=i.anchorOffsetY=20,i}return __extends(s,e),s.prototype.init=function(){},s}(egret.DisplayObjectContainer);__reflect(ChessmanFive.prototype,"ChessmanFive");var ChessmanShadow=function(e){function s(s){var i=e.call(this)||this;return i.INIT_X=0,i.INIT_Y=0,i.img1=App.DisplayUtils.createBitmap("chessman_"+s+"_png"),i.img2=App.DisplayUtils.createBitmap("img_redying_png"),i.addChild(i.img1),i.addChild(i.img2),i.touchEnabled=!1,i.touchChildren=!1,i.img1.anchorOffsetX=i.img1.anchorOffsetY=20,i.img2.anchorOffsetX=i.img2.anchorOffsetY=100,i}return __extends(s,e),s.prototype.init=function(){},s}(egret.DisplayObjectContainer);__reflect(ChessmanShadow.prototype,"ChessmanShadow");var GameFiveExpressView=function(e){function s(){var s=e.call(this,GameFiveExpressSkin)||this;s.numTimeRefuseSum=5,s.btn_sumNo.addEventListener(egret.TouchEvent.TOUCH_TAP,s.onCancelSum,s),s.btn_loseNo.addEventListener(egret.TouchEvent.TOUCH_TAP,s.onCancelLose,s);var i=RES.getRes("FiveinARowMessage_json").euiMessage;switch(s.lb_sum.text=i[1001],s.lb_sumDescribe.text=i[1002],s.lb_lose.text=i[1003],s.lb_loseDescribe.text=i[1004],s.btn_loseYes.label=i[1005],s.btn_loseNo.label=i[1006],s.btn_sumYes.label=i[1007],App.Language){case LanguageType.En:s.lb_sumDescribe.size=18,s.lb_loseDescribe.size=24}return s}return __extends(s,e),s.prototype.onCancelSum=function(){switch(this.gp_sum.visible=!1,App.Language){case LanguageType.Ch:this.btn_sumNo.label="拒绝(5秒)";break;case LanguageType.En:this.btn_sumNo.label="refuse(5s)"}},s.prototype.onCancelLose=function(){this.gp_lose.visible=!1},s}(EuiComponent);__reflect(GameFiveExpressView.prototype,"GameFiveExpressView");var GameFiveinARowView=function(e){function s(){var i=e.call(this)||this;return i.num_beginX=0,i.num_beginY=329,i.num_YIN_X=0,i.num_YIM_Y=0,i.num_YIN_W=0,i.num_YIM_H=0,i.Obj_Pot={},i.Obj_Chess={},i.SELF_TYPE=1,i.ENENY_TYPE=2,i.ShadowChess=null,i.numSelfSuccess_1=0,i.numSelfSuccess_2=0,i.numSelfSuccess_3=0,i.numSelfSuccess_4=0,i.isSelfRound=!1,i.isEffectLoction=!1,i.num_time=45,i.num_sum=1,i.str_whoRound="",i.isGameOver=!1,i.selfIsWin=!1,i.numChess=0,i.chessboardArr=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],i.pauseCallback=function(){App.MessageCenter.dispatch(EventMessage.SendGameResultC2S,1),i.next("gameChangeMatch")},i.isExpress=!1,s.volume_global=new SoundEffects,s.volume_global.setVolume(1),egret.lifecycle.onPause=function(){App.SoundManager.setBgOn(!1),App.SoundManager.setEffectOn(!1),console.log("PAUSE!"),s.volume_global&&s.volume_global.setVolume(0)},egret.lifecycle.onResume=function(){App.SoundManager.setBgOn(!0),App.SoundManager.setEffectOn(!0),console.log("RESUME!"),s.volume_global&&s.volume_global.setVolume(1)},i}return __extends(s,e),s.prototype.init=function(){e.prototype.init.call(this),this.ArrMessage=RES.getRes("FiveinARowMessage_json").ArrMessage,this.container=new egret.DisplayObjectContainer,this.addChild(this.container);var i=App.GameWidth/s.GAME_WIDTH,t=App.GameHeight/s.GAME_HEIGHT,n=Math.min(i,t);this.container.scaleX=this.container.scaleY=n,this.container.x=.5*(App.GameWidth-s.GAME_WIDTH*n),this.container.y=.5*(App.GameHeight-s.GAME_HEIGHT*n),this.GameContainer=new egret.DisplayObjectContainer,this.GameContainer.width=this.container.width,this.GameContainer.height=this.container.height,this.container.addChild(this.GameContainer),this.BaseComment=new GameFiveExpressView,this.addChild(this.BaseComment),this.BaseComment.width=App.GameWidth,this.BaseComment.height=App.GameHeight,App.GameHeight<s.GAME_HEIGHT&&(this.BaseComment.gp_game.scaleX=App.GameHeight/s.GAME_HEIGHT,this.BaseComment.gp_game.scaleY=App.GameHeight/s.GAME_HEIGHT);var h=DataCenter.instance.user;this.BaseComment.lb_name1.text=h.name,this.BaseComment.img_sex1.source=GameCenterGetSexIcon.getSexIconSource(h.sex);var o=new RoleHeadImage(h.imgUrl);o.scaleX=o.scaleY=.85,this.BaseComment.playerAvatarGroup1.addChild(o);var a=DataCenter.instance.room.player;this.BaseComment.lb_name2.text=a.name,this.BaseComment.img_sex2.source=GameCenterGetSexIcon.getSexIconSource(a.sex);var r=new RoleHeadImage(a.imgUrl);r.scaleX=r.scaleY=.85,this.BaseComment.playerAvatarGroup2.addChild(r),this.onDraw();for(var _=1;6>=_;++_)this.BaseComment["btn_express"+_].addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendMessage,this),this.BaseComment.lb_untouch.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onExpressBegin,this),this.BaseComment.lb_untouch.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onExpressCancel,this),this.BaseComment.lb_untouch.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onExpressCancel,this),this.BaseComment.lb_untouch.addEventListener(egret.TouchEvent.TOUCH_END,this.onExpressCancel,this),this.BaseComment["btn_express"+_].addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onExpressBegin,this),this.BaseComment["btn_express"+_].addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onExpressCancel,this),this.BaseComment["btn_express"+_].addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onExpressCancel,this),this.BaseComment["btn_express"+_].addEventListener(egret.TouchEvent.TOUCH_END,this.onExpressCancel,this);this.BaseComment.gp_game.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onbegin,this),this.BaseComment.gp_game.addEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),this.BaseComment.gp_game.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),this.BaseComment.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goBackBtnHandler,this),(App.IsXiaoMi||App.IsWanba)&&(this.BaseComment.btn_return.visible=!1,this.BaseComment.btn_return.touchEnabled=!1),this.BaseComment.btn_sum.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSum,this),this.BaseComment.btn_lose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLose,this),this.BaseComment.btn_sumYes.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeSum,this),this.BaseComment.btn_sumNo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRefuseSum,this),this.BaseComment.btn_loseYes.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgreeLose,this),App.MessageCenter.addListener(EventMessage.ReceiveGameEventS2C,this.onGameEvent,this),App.MessageCenter.addListener(EventMessage.ReceiveGameResultS2C,this.onGameResult,this),App.MessageCenter.addListener(EventMessage.pauseMessage,this.pauseCallback,this),this.AIObj=new AIChessFive},s.prototype.onGameResult=function(e){this.stop(),DataCenter.instance.room.gameResult=e,this.popup("GameResult")},s.prototype.stop=function(){},s.prototype.onDraw=function(){this.num_beginX=Math.floor((App.GameWidth-588)/2),this.num_YIN_X=this.num_beginX-s.LINE_DISTANCE/2,this.num_YIM_Y=this.num_beginY+2*s.LINE_DISTANCE,this.num_YIN_W=this.num_YIN_X+630,this.num_YIM_H=this.num_YIM_Y+630,this.onCollectPot()},s.prototype.onbegin=function(e){if(this.isSelfRound&&!this.isGameOver&&!this.isExpress&&1!=this.BaseComment.gp_sum.visible&&1!=this.BaseComment.gp_lose.visible&&this.onJudceEffect(e.stageX,e.stageY)){this.isEffectLoction=!0;var i=Math.floor((e.stageX-this.num_YIN_X)/s.LINE_DISTANCE),t=Math.floor((e.stageY-this.num_YIM_Y)/s.LINE_DISTANCE);i>14&&(i=14),t>14&&(t=14),this.ShadowChess.x=this.Obj_Pot[""+i+"_"+t][0],this.ShadowChess.y=this.Obj_Pot[""+i+"_"+t][1],this.ShadowChess.INIT_X=i,this.ShadowChess.INIT_Y=t,this.ShadowChess.visible=!0}},s.prototype.onMove=function(e){if(this.isEffectLoction&&this.isSelfRound&&!this.isGameOver&&!this.isExpress)if(this.onJudceEffect(e.stageX,e.stageY)){var i=Math.floor((e.stageX-this.num_YIN_X)/s.LINE_DISTANCE),t=Math.floor((e.stageY-this.num_YIM_Y)/s.LINE_DISTANCE);i>14&&(i=14),t>14&&(t=14),this.ShadowChess.x=this.Obj_Pot[""+i+"_"+t][0],this.ShadowChess.y=this.Obj_Pot[""+i+"_"+t][1],this.ShadowChess.INIT_X=i,this.ShadowChess.INIT_Y=t,this.ShadowChess.visible=!0}else this.ShadowChess.visible=!1},s.prototype.onEnd=function(e){if(this.isEffectLoction&&this.isSelfRound&&!this.isGameOver&&!this.isExpress&&this.ShadowChess.visible&&(this.ShadowChess.visible=!1,0==this.chessboardArr[this.ShadowChess.INIT_X][this.ShadowChess.INIT_Y])){var i=new ChessmanFive(this.SELF_TYPE);i.x=this.Obj_Pot[""+this.ShadowChess.INIT_X+"_"+this.ShadowChess.INIT_Y][0],i.y=this.Obj_Pot[""+this.ShadowChess.INIT_X+"_"+this.ShadowChess.INIT_Y][1],this.BaseComment.img_red.visible=!0,this.BaseComment.img_red.x=i.x,this.BaseComment.img_red.y=i.y,this.BaseComment.gp_chess.addChild(i),s.volume_global.play("down_chess_mp3",!0),this.Obj_Chess[""+this.ShadowChess.INIT_X+"_"+this.ShadowChess.INIT_Y]=i,this.onChessNumber(),this.AIObj.InitValueX=this.ShadowChess.INIT_X,this.AIObj.InitValueY=this.ShadowChess.INIT_Y,this.chessboardArr[this.ShadowChess.INIT_X][this.ShadowChess.INIT_Y]=this.SELF_TYPE,this.isSelfRound=!1,this.onStatusChange(),this.onJudceSuccess(this.ShadowChess.INIT_X,this.ShadowChess.INIT_Y)}},s.prototype.onJudceEffect=function(e,s){var i=e,t=s;return i>=this.num_YIN_X&&i<=this.num_YIN_W&&t>=this.num_YIM_Y&&t<=this.num_YIM_H-30?!0:!1},s.prototype.onJudceSuccess=function(e,s){var i=this;this.numSelfSuccess_1=1,this.numSelfSuccess_2=1,this.numSelfSuccess_3=1,this.numSelfSuccess_4=1,this.onJudce(e,s);var t=0;if(this.numSelfSuccess_1>=5&&(t=1),this.numSelfSuccess_2>=5&&(t=2),this.numSelfSuccess_3>=5&&(t=3),this.numSelfSuccess_4>=5&&(t=4),DataCenter.instance.room.IsAI)0!=t||this.isGameOver||(this.AIObj.ChessArr=this.chessboardArr,this.AIObj.onJudce(),App.TimerManager.doTimer(3e3,1,function(){i.onAddEnemy(i.AIObj.Decision_X,i.AIObj.Decision_Y,i.AIObj.AIWin)},this));else{var n="sendOperation|"+e+"|"+s+"|"+t;App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,n)}t>0?(this.selfIsWin=!0,this.onFiveSuccessCartoon(e,s,t),App.TimerManager.doTimer(4500,1,function(){i.gameOver(3)},this)):this.AIObj.AIWin>0&&App.TimerManager.doTimer(7500,1,function(){i.gameOver(1)},this)},s.prototype.gameOver=function(e){App.MessageCenter.dispatch(EventMessage.SendGameResultC2S,e)},s.prototype.onJudce=function(e,s){for(var i=1;5>i;i++){var t=e-i;if(0>t)break;if(this.chessboardArr[t][s]!=this.SELF_TYPE)break;this.numSelfSuccess_1++}for(var i=1;5>i;i++){var n=e+i;if(n>14)break;if(this.chessboardArr[n][s]!=this.SELF_TYPE)break;this.numSelfSuccess_1++}for(var i=1;5>i;i++){var h=s-i;if(0>h)break;if(this.chessboardArr[e][h]!=this.SELF_TYPE)break;this.numSelfSuccess_2++}for(var i=1;5>i;i++){var o=s+i;if(o>14)break;if(this.chessboardArr[e][o]!=this.SELF_TYPE)break;this.numSelfSuccess_2++}for(var i=1;5>i;i++){var a=e-i,r=s-i;if(0>a||0>r)break;if(this.chessboardArr[a][r]!=this.SELF_TYPE)break;this.numSelfSuccess_3++}for(var i=1;5>i;i++){var _=e+i,m=s+i;if(_>14||m>14)break;if(this.chessboardArr[_][m]!=this.SELF_TYPE)break;this.numSelfSuccess_3++}for(var i=1;5>i;i++){var c=e-i,u=s+i;if(0>c||u>14)break;if(this.chessboardArr[c][u]!=this.SELF_TYPE)break;this.numSelfSuccess_4++}for(var i=1;5>i;i++){var p=e+i,l=s-i;if(p>14||0>l)break;if(this.chessboardArr[p][l]!=this.SELF_TYPE)break;this.numSelfSuccess_4++}},s.prototype.onCollectPot=function(){for(var e=0;15>e;e++)for(var s=0;15>s;s++){var i=[0,0];i[0]=42*e+26,i[1]=42*s+this.num_beginY,this.Obj_Pot[""+e+"_"+s]=i}},s.prototype.show=function(){e.prototype.show.call(this),DataCenter.instance.room.selfIsMaster?(this.SELF_TYPE=1,this.ENENY_TYPE=2,this.onTipsShow(0),this.isSelfRound=!0):(this.SELF_TYPE=2,this.ENENY_TYPE=1,this.onTipsShow(1),this.isSelfRound=!1),this.BaseComment.img_Chesstype1.source="img_he"+this.SELF_TYPE+"_png",this.BaseComment.img_Chesstype2.source="img_he"+this.ENENY_TYPE+"_png",this.onStatusChange(),this.ShadowChess=new ChessmanShadow(this.SELF_TYPE),this.ShadowChess.visible=!1,this.BaseComment.gp_red.addChild(this.ShadowChess),App.SoundManager.stopBg(),App.SoundManager.playBg("bg_fiveMusic_mp3")},s.prototype.onGameEvent=function(e){var i=this,t=function(e){var s=e.split("|");return s},n=t(e.event);switch(n[0]){case"sendOperation":this.onAddEnemy(n[1],n[2],n[3]);break;case"sendExpress":this.addQiPaoCartoon(n[1],2);break;case"giveUp":this.isGameOver=!0,s.volume_global.play("five_win_mp3",!0),this.onTipsShow(3),App.TimerManager.doTimer(3e3,1,function(){i.gameOver(3)},this);break;case"SumShow":this.BaseComment.gp_sum.visible=!0,this.BaseComment.numTimeRefuseSum=5;break;case"AGreeSum":this.onTipsShow(6),this.isGameOver=!0,this.onTipsShow(2),App.TimerManager.doTimer(3e3,1,function(){i.gameOver(2)},this);break;case"RefuseSum":this.onTipsShow(5)}},s.prototype.onAddEnemy=function(e,i,t){var n=new ChessmanFive(this.ENENY_TYPE);n.x=this.Obj_Pot[""+e+"_"+i][0],n.y=this.Obj_Pot[""+e+"_"+i][1],this.BaseComment.img_red.visible=!0,this.BaseComment.img_red.x=n.x,this.BaseComment.img_red.y=n.y,this.BaseComment.gp_chess.addChild(n),s.volume_global.play("down_chess_mp3",!0),this.Obj_Chess[""+e+"_"+i]=n,this.onChessNumber(),this.chessboardArr[e][i]=this.ENENY_TYPE,0==t?(this.isSelfRound=!0,this.onStatusChange()):this.onFiveSuccessCartoon(Number(e),Number(i),Number(t))},s.prototype.onChessNumber=function(){var e=this;this.numChess++,this.numChess>=225&&(this.isGameOver=!0,this.onTipsShow(2),App.TimerManager.doTimer(3e3,1,function(){e.gameOver(2)},this))},s.prototype.goBackBtnHandler=function(){this.popup("GameSureLeave")},s.prototype.onSum=function(){var e=this;this.isGameOver||1==this.num_sum&&(this.num_sum--,this.onTipsShow(4),DataCenter.instance.room.IsAI?App.TimerManager.doTimer(2e3,1,function(){e.onTipsShow(5)},this):App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,"SumShow"))},s.prototype.onLose=function(){this.isGameOver||(this.BaseComment.gp_lose.visible=!0)},s.prototype.onAgreeSum=function(){var e=this;this.BaseComment.gp_sum.visible=!1,App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,"AGreeSum"),this.isGameOver=!0,this.onTipsShow(2),App.TimerManager.doTimer(3e3,1,function(){e.gameOver(2)},this)},s.prototype.onAgreeLose=function(){DataCenter.instance.room.IsAI?this.gameOver(1):App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,"giveUp"),this.isGameOver=!0,s.volume_global.play("five_lose_mp3",!0),this.BaseComment.gp_lose.visible=!1},s.prototype.onRefuseSum=function(){App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,"RefuseSum")},s.prototype.onFiveSuccessCartoon=function(e,i,t){this.isGameOver=!0,this.selfIsWin?s.volume_global.play("five_win_mp3",!0):s.volume_global.play("five_lose_mp3",!0),this.BaseComment.gp_lose.visible=!1,this.BaseComment.gp_sum.visible=!1;var n;n=t>2?this.BaseComment.img_aperture_2:this.BaseComment.img_aperture_1,t%2==0&&(n.rotation=90);var h=e,o=i;switch(t){case 1:for(var a=0;11>a;++a)for(var r=0;15>r;r++){for(var _="",m=0;5>m;++m)_+=this.chessboardArr[a+m][r];("11111"==_||"22222"==_)&&(h=a+2,o=r)}break;case 2:for(var a=0;15>a;++a)for(var r=0;11>r;r++){for(var _="",m=0;5>m;++m)_+=this.chessboardArr[a][r+m];("11111"==_||"22222"==_)&&(h=a,o=r+2)}break;case 3:for(var a=0;11>a;++a)for(var r=0;11>r;r++){for(var _="",m=0;5>m;++m)_+=this.chessboardArr[a+m][r+m];("11111"==_||"22222"==_)&&(h=a+2,o=r+2)}break;case 4:for(var a=4;15>a;++a)for(var r=0;11>r;r++){for(var _="",m=0;5>m;++m)_+=this.chessboardArr[a-m][r+m];("11111"==_||"22222"==_)&&(h=a-2,o=r+2)}}n.x=this.Obj_Pot[""+h+"_"+o][0],n.y=this.Obj_Pot[""+h+"_"+o][1],n.visible=!0,egret.Tween.get(n).to({scaleX:1.5,scaleY:1.5,alpha:0},1500).call(function(){})},s.prototype.onTipsShow=function(e){var s=this;this.BaseComment.lb_tip.text="",this.BaseComment.gp_tipMessage.alpha=1,this.BaseComment.lb_tip.text=this.ArrMessage[e],3==e||4==e||5==e||6==e?this.BaseComment.lb_tip.size=23:this.BaseComment.lb_tip.size=30,egret.Tween.get(this.BaseComment.gp_tipMessage).wait(1e3).to({alpha:0},500).call(function(){App.TimerManager.doTimer(1e3,0,s.onTimerUpdate,s)})},s.prototype.addQiPaoCartoon=function(e,s){void 0===s&&(s=1);var i=new QIPaoCartoon;if(i.y=App.RandomUtils.limitInteger(120,130),this.addChild(i),2==s)i.x=App.RandomUtils.limitInteger(App.GameWidth-165,App.GameWidth-145),i.setSouce(e,!0,1);else if(i.setSouce(e,!1,1),i.x=App.RandomUtils.limitInteger(145,165),DataCenter.instance.room.IsAI){var t=App.RandomUtils.limitInteger(1,5);t%2!=0&&App.TimerManager.doTimer(1e3*t,1,this.AddAIexpress,this)}else{var n="sendExpress|"+e;App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,n)}1==s?(i.img_1.scaleX=-1,i.onPlay(1)):i.onPlay(2)},s.prototype.AddAIexpress=function(){var e=App.RandomUtils.limitInteger(1,6),s="Express_five"+e+"_png";this.addQiPaoCartoon(s,2)},s.prototype.onSendMessage=function(e){var s=egret.getTimer();if(s-DataCenter.instance.SendExpressTime>500){DataCenter.instance.SendExpressTime=s;var i="Express_five"+e.target.name+"_png";this.addQiPaoCartoon(i,1)}},s.prototype.onExpressBegin=function(){this.isExpress=!0},s.prototype.onExpressCancel=function(){this.isExpress=!1},s.prototype.dispose=function(){e.prototype.dispose.call(this),App.TimerManager.remove(this.onTimerUpdate,this),App.MessageCenter.removeListener(EventMessage.ReceiveGameEventS2C,this.onGameEvent,this),App.MessageCenter.removeListener(EventMessage.ReceiveGameResultS2C,this.onGameResult,this),App.MessageCenter.removeListener(EventMessage.pauseMessage,this.pauseCallback,this)},s.prototype.onStatusChange=function(){if(this.num_time=45,this.isSelfRound){switch(App.Language){case LanguageType.Ch:this.BaseComment.lb_time.text="你的回合 "+this.num_time+"s";break;case LanguageType.En:this.BaseComment.lb_time.text="Your turn "+this.num_time+"s"}this.num_sum=1,2==this.SELF_TYPE?(this.BaseComment.lb_time.textColor=5921370,this.BaseComment.bg_wait.source="chess_row2_png"):(this.BaseComment.lb_time.textColor=16777215,this.BaseComment.bg_wait.source="chess_row1_png"),this.BaseComment.bg_wait.horizontalCenter=-23,this.BaseComment.bg_wait.scaleX=-1}else{switch(App.Language){case LanguageType.Ch:this.BaseComment.lb_time.text="对手回合 "+this.num_time+"s";break;case LanguageType.En:this.BaseComment.lb_time.text="Opponent turn "+this.num_time+"s"}2==this.ENENY_TYPE?(this.BaseComment.lb_time.textColor=5921370,this.BaseComment.bg_wait.source="chess_row2_png"):(this.BaseComment.lb_time.textColor=16777215,this.BaseComment.bg_wait.source="chess_row1_png"),this.BaseComment.bg_wait.horizontalCenter=23,this.BaseComment.bg_wait.scaleX=1}},s.prototype.onTimerUpdate=function(){var e=this;if(this.isGameOver)return void App.TimerManager.remove(this.onTimerUpdate,this);if(!(this.num_time>0))return void(this.isSelfRound&&(DataCenter.instance.room.IsAI||App.MessageCenter.dispatch(EventMessage.SendGameEventC2S,"giveUp"),this.isGameOver=!0,this.onTipsShow(7),App.TimerManager.doTimer(2e3,1,function(){e.gameOver(1)},this)));if(this.num_time--,this.num_time<=10&&s.volume_global.play("time_Fivelast_mp3",!0),1==this.BaseComment.gp_sum.visible)if(this.BaseComment.numTimeRefuseSum--,this.BaseComment.numTimeRefuseSum>0)switch(App.Language){case LanguageType.Ch:this.BaseComment.btn_sumNo.label="拒绝("+this.BaseComment.numTimeRefuseSum+"秒)";break;case LanguageType.En:this.BaseComment.btn_sumNo.label="refuse("+this.BaseComment.numTimeRefuseSum+"s)"}else this.onRefuseSum(),this.BaseComment.gp_sum.visible=!1;if(this.isSelfRound)switch(App.Language){case LanguageType.Ch:this.BaseComment.lb_time.text="你的回合 "+this.num_time+"s";break;case LanguageType.En:this.BaseComment.lb_time.text="Your turn "+this.num_time+"s"}else switch(App.Language){case LanguageType.Ch:this.BaseComment.lb_time.text="对手回合 "+this.num_time+"s";break;case LanguageType.En:this.BaseComment.lb_time.text="Opponent turn "+this.num_time+"s"
}},s.GAME_WIDTH=640,s.GAME_HEIGHT=1136,s.LINE_DISTANCE=42,s.AILEVEL=0,s}(State);__reflect(GameFiveinARowView.prototype,"GameFiveinARowView");